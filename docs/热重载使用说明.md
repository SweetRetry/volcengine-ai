# Airçƒ­é‡è½½ä½¿ç”¨è¯´æ˜

## ğŸš€ å¿«é€Ÿå¼€å§‹

é¡¹ç›®ä½¿ç”¨Airå®ç°çƒ­é‡è½½åŠŸèƒ½ï¼Œè®©ä½ åœ¨å¼€å‘è¿‡ç¨‹ä¸­ä¿®æ”¹ä»£ç åè‡ªåŠ¨é‡æ–°ç¼–è¯‘å’Œå¯åŠ¨æœåŠ¡å™¨ã€‚

### å¯åŠ¨çƒ­é‡è½½

```bash
# ç›´æ¥å¯åŠ¨
air

# æˆ–ä½¿ç”¨makeå‘½ä»¤
make dev
```

### å®‰è£…Air

å¦‚æœè¿˜æ²¡æœ‰å®‰è£…Airï¼š

```bash
go install github.com/cosmtrek/air@latest
```

## âš™ï¸ é…ç½®è¯´æ˜

é¡¹ç›®çš„Airé…ç½®æ–‡ä»¶ä½äº `.air.toml`ï¼Œå·²ç»ä¸ºé¡¹ç›®ä¼˜åŒ–é…ç½®ï¼š

### ç›‘æ§èŒƒå›´

- **ç›‘æ§ç›®å½•**: `cmd/`, `internal/`
- **ç›‘æ§æ–‡ä»¶**: `.go`, `.env`, `.html`, `.tmpl`, `.tpl`
- **æ’é™¤ç›®å½•**: `.git/`, `tmp/`, `vendor/`, `testdata/`, `node_modules/`, `.vscode/`
- **æ’é™¤æ–‡ä»¶**: æµ‹è¯•æ–‡ä»¶ã€ä¸´æ—¶æ–‡ä»¶ã€ç¼–è¾‘å™¨ä¸´æ—¶æ–‡ä»¶

### ä¸»è¦é…ç½®

```toml
[build]
  cmd = "go build -o ./tmp/main ./cmd/server"
  bin = "./tmp/main"
  delay = 1000                    # å»¶è¿Ÿ1ç§’åé‡æ–°æ„å»º
  kill_delay = "2s"              # è¿›ç¨‹ç»ˆæ­¢å»¶è¿Ÿ2ç§’
  send_interrupt = true          # å‘é€ä¸­æ–­ä¿¡å·

[log]
  time = true                    # æ˜¾ç¤ºæ—¶é—´æˆ³

[misc]
  clean_on_exit = true          # é€€å‡ºæ—¶æ¸…ç†

[screen]
  clear_on_rebuild = true       # é‡å»ºæ—¶æ¸…å±
```

## ğŸ¯ VS Codeé›†æˆ

### è¿è¡Œä»»åŠ¡

1. æŒ‰ `Ctrl+Shift+P`ï¼ˆmacOS: `Cmd+Shift+P`ï¼‰
2. è¾“å…¥ "Tasks: Run Task"
3. é€‰æ‹© "Air: Hot Reload"

### å¯ç”¨ä»»åŠ¡

- `Air: Hot Reload` - å¯åŠ¨Airçƒ­é‡è½½
- `Go: Build` - æ„å»ºé¡¹ç›®
- `Go: Run` - è¿è¡Œé¡¹ç›®
- `Test: All` - è¿è¡Œæ‰€æœ‰æµ‹è¯•
- `Test: Coverage` - è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š

## ğŸ› æ•…éšœæ’é™¤

### Airæ— æ³•å¯åŠ¨

```bash
# æ£€æŸ¥Airæ˜¯å¦å®‰è£…
which air

# é‡æ–°å®‰è£…Air
go install github.com/cosmtrek/air@latest

# æ£€æŸ¥é…ç½®æ–‡ä»¶
cat .air.toml
```

### ç«¯å£è¢«å ç”¨

```bash
# æŸ¥æ‰¾å ç”¨ç«¯å£çš„è¿›ç¨‹
lsof -i :8080

# æ€æ­»è¿›ç¨‹
kill -9 <PID>
```

### æ–‡ä»¶ç›‘æ§ä¸å·¥ä½œ

```bash
# æ£€æŸ¥æ–‡ä»¶æƒé™
ls -la .air.toml

# æ£€æŸ¥ç›‘æ§çš„ç›®å½•æ˜¯å¦å­˜åœ¨
ls -la cmd/ internal/

# é‡æ–°å¯åŠ¨çƒ­é‡è½½
pkill air
air
```

### MongoDB/Redisè¿æ¥å¤±è´¥

```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€ï¼ˆmacOSï¼‰
brew services list | grep mongodb
brew services list | grep redis

# å¯åŠ¨æœåŠ¡
brew services start mongodb-community
brew services start redis
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### å‡å°‘ç›‘æ§æ–‡ä»¶æ•°é‡

å¦‚æœé¡¹ç›®å˜å¤§ï¼Œå¯ä»¥åœ¨ `.air.toml` ä¸­æ·»åŠ æ›´å¤šæ’é™¤è§„åˆ™ï¼š

```toml
[build]
  exclude_regex = ["_test.go", ".*_test\\.go$", "\\.#.*", ".*\\.swp$", ".*\\.tmp$", ".*\\.log$"]
```

### è°ƒæ•´å»¶è¿Ÿæ—¶é—´

```toml
[build]
  delay = 500              # å‡å°‘å»¶è¿Ÿæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
  rerun_delay = 200        # å‡å°‘é‡æ–°è¿è¡Œå»¶è¿Ÿ
```

## ğŸš€ ç”Ÿäº§ç¯å¢ƒæ³¨æ„äº‹é¡¹

âš ï¸ **é‡è¦**: Airä»…ç”¨äºå¼€å‘ç¯å¢ƒï¼Œä¸è¦åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ã€‚

ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²ï¼š

```bash
# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
make build-linux

# ä½¿ç”¨Dockeréƒ¨ç½²
make docker-build
make docker-run
```

## ğŸ“š ç›¸å…³èµ„æº

- [Airå®˜æ–¹æ–‡æ¡£](https://github.com/cosmtrek/air)
- [Goå¼€å‘æœ€ä½³å®è·µ](https://golang.org/doc/effective_go.html)
- [VS Code Goæ‰©å±•](https://marketplace.visualstudio.com/items?itemName=golang.Go) 